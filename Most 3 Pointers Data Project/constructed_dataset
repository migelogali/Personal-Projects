import pandas as pd

# Load (or scrape) the table
df = pd.read_html("https://www.basketball-reference.com/leaders/fg3_yearly.html")[0]

# Only keep necessary columns (until i get rid of Lg later)
df = df[['Season', '3P', 'Lg']]

# Drop rows where 'Season' is missing or not a string
df = df[df['Season'].apply(lambda x: isinstance(x, str))]

# Convert 'Season' to season-end year
def season_to_end_year(season_str):
    start, end = season_str.split('-')
    start = int(start)
    end = int(end)
    if end < 50:
        end += 2000
    else:
        end += 1900
    return end

df['Season_End_Year'] = df['Season'].apply(season_to_end_year)

# Keep only NBA seasons
# ABA entries are labeled 'ABA' in the 'Lg' column
df = df[df['Lg'] != 'ABA']

# Rename columns to match what we want
df.rename(columns={
    '3P': 'Most_3PM'
}, inplace=True)

# Keep only the columns you care about
df = df[['Season_End_Year', 'Most_3PM']]
df_final = df[df['Season_End_Year'] <= 2025]

# Save to CSV
df_final.to_csv("season_leader_3p_made.csv", index=False)
